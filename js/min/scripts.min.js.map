{"version":3,"sources":["node_modules/browser-pack/_prelude.js","js/main.js","js/modernizr-webp.js","js/navigation.js","js/scripts.js","js/skip-link-focus-fix.js","js/vendor/object-fit-videos.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"scripts.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","require('./modernizr-webp');\nrequire('./vendor/object-fit-videos');\n\nrequire('./navigation');\nrequire('./skip-link-focus-fix');\nrequire('./scripts');\n","/*! modernizr 3.6.0 (Custom Build) | MIT *\n * https://modernizr.com/download/?-webp-setclasses !*/\n!function(e,n,A){function o(e){var n=r.className,A=Modernizr._config.classPrefix||\"\";if(l&&(n=n.baseVal),Modernizr._config.enableJSClass){var o=new RegExp(\"(^|\\\\s)\"+A+\"no-js(\\\\s|$)\");n=n.replace(o,\"$1\"+A+\"js$2\")}Modernizr._config.enableClasses&&(n+=\" \"+A+e.join(\" \"+A),l?r.className.baseVal=n:r.className=n)}function t(e,n){return typeof e===n}function a(){var e,n,A,o,a,i,r;for(var l in f)if(f.hasOwnProperty(l)){if(e=[],n=f[l],n.name&&(e.push(n.name.toLowerCase()),n.options&&n.options.aliases&&n.options.aliases.length))for(A=0;A<n.options.aliases.length;A++)e.push(n.options.aliases[A].toLowerCase());for(o=t(n.fn,\"function\")?n.fn():n.fn,a=0;a<e.length;a++)i=e[a],r=i.split(\".\"),1===r.length?Modernizr[r[0]]=o:(!Modernizr[r[0]]||Modernizr[r[0]]instanceof Boolean||(Modernizr[r[0]]=new Boolean(Modernizr[r[0]])),Modernizr[r[0]][r[1]]=o),s.push((o?\"\":\"no-\")+r.join(\"-\"))}}function i(e,n){if(\"object\"==typeof e)for(var A in e)c(e,A)&&i(A,e[A]);else{e=e.toLowerCase();var t=e.split(\".\"),a=Modernizr[t[0]];if(2==t.length&&(a=a[t[1]]),\"undefined\"!=typeof a)return Modernizr;n=\"function\"==typeof n?n():n,1==t.length?Modernizr[t[0]]=n:(!Modernizr[t[0]]||Modernizr[t[0]]instanceof Boolean||(Modernizr[t[0]]=new Boolean(Modernizr[t[0]])),Modernizr[t[0]][t[1]]=n),o([(n&&0!=n?\"\":\"no-\")+t.join(\"-\")]),Modernizr._trigger(e,n)}return Modernizr}var s=[],r=n.documentElement,l=\"svg\"===r.nodeName.toLowerCase(),f=[],u={_version:\"3.6.0\",_config:{classPrefix:\"\",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,n){var A=this;setTimeout(function(){n(A[e])},0)},addTest:function(e,n,A){f.push({name:e,fn:n,options:A})},addAsyncTest:function(e){f.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=u,Modernizr=new Modernizr;var c;!function(){var e={}.hasOwnProperty;c=t(e,\"undefined\")||t(e.call,\"undefined\")?function(e,n){return n in e&&t(e.constructor.prototype[n],\"undefined\")}:function(n,A){return e.call(n,A)}}(),u._l={},u.on=function(e,n){this._l[e]||(this._l[e]=[]),this._l[e].push(n),Modernizr.hasOwnProperty(e)&&setTimeout(function(){Modernizr._trigger(e,Modernizr[e])},0)},u._trigger=function(e,n){if(this._l[e]){var A=this._l[e];setTimeout(function(){var e,o;for(e=0;e<A.length;e++)(o=A[e])(n)},0),delete this._l[e]}},Modernizr._q.push(function(){u.addTest=i}),Modernizr.addAsyncTest(function(){function e(e,n,A){function o(n){var o=n&&\"load\"===n.type?1==t.width:!1,a=\"webp\"===e;i(e,a&&o?new Boolean(o):o),A&&A(n)}var t=new Image;t.onerror=o,t.onload=o,t.src=n}var n=[{uri:\"data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA=\",name:\"webp\"},{uri:\"data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA==\",name:\"webp.alpha\"},{uri:\"data:image/webp;base64,UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA\",name:\"webp.animation\"},{uri:\"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=\",name:\"webp.lossless\"}],A=n.shift();e(A.name,A.uri,function(A){if(A&&\"load\"===A.type)for(var o=0;o<n.length;o++)e(n[o].name,n[o].uri)})}),a(),o(s),delete u.addTest,delete u.addAsyncTest;for(var p=0;p<Modernizr._q.length;p++)Modernizr._q[p]();e.Modernizr=Modernizr}(window,document);","/**\n * File navigation.js.\n *\n * Handles toggling the navigation menu for small screens and enables TAB key\n * navigation support for dropdown menus.\n */\n( function() {\n\tvar container, button, menu, links, i, len;\n\n\tcontainer = document.getElementById( 'site-navigation' );\n\tif ( ! container ) {\n\t\treturn;\n\t}\n\n\tbutton = container.getElementsByTagName( 'button' )[0];\n\tif ( 'undefined' === typeof button ) {\n\t\treturn;\n\t}\n\n\tmenu = container.getElementsByTagName( 'ul' )[0];\n\n\t// Hide menu toggle button if menu is empty and return early.\n\tif ( 'undefined' === typeof menu ) {\n\t\tbutton.style.display = 'none';\n\t\treturn;\n\t}\n\n\tmenu.setAttribute( 'aria-expanded', 'false' );\n\tif ( -1 === menu.className.indexOf( 'nav-menu' ) ) {\n\t\tmenu.className += ' nav-menu';\n\t}\n\n\tbutton.onclick = function() {\n\t\tif ( -1 !== container.className.indexOf( 'toggled' ) ) {\n\t\t\tcontainer.className = container.className.replace( ' toggled', '' );\n\t\t\tbutton.setAttribute( 'aria-expanded', 'false' );\n\t\t\tmenu.setAttribute( 'aria-expanded', 'false' );\n\t\t} else {\n\t\t\tcontainer.className += ' toggled';\n\t\t\tbutton.setAttribute( 'aria-expanded', 'true' );\n\t\t\tmenu.setAttribute( 'aria-expanded', 'true' );\n\t\t}\n\t};\n\n\t// Get all the link elements within the menu.\n\tlinks    = menu.getElementsByTagName( 'a' );\n\n\t// Each time a menu link is focused or blurred, toggle focus.\n\tfor ( i = 0, len = links.length; i < len; i++ ) {\n\t\tlinks[i].addEventListener( 'focus', toggleFocus, true );\n\t\tlinks[i].addEventListener( 'blur', toggleFocus, true );\n\t}\n\n\t/**\n\t * Sets or removes .focus class on an element.\n\t */\n\tfunction toggleFocus() {\n\t\tvar self = this;\n\n\t\t// Move up through the ancestors of the current link until we hit .nav-menu.\n\t\twhile ( -1 === self.className.indexOf( 'nav-menu' ) ) {\n\n\t\t\t// On li elements toggle the class .focus.\n\t\t\tif ( 'li' === self.tagName.toLowerCase() ) {\n\t\t\t\tif ( -1 !== self.className.indexOf( 'focus' ) ) {\n\t\t\t\t\tself.className = self.className.replace( ' focus', '' );\n\t\t\t\t} else {\n\t\t\t\t\tself.className += ' focus';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tself = self.parentElement;\n\t\t}\n\t}\n\n\t/**\n\t * Toggles `focus` class to allow submenu access on tablets.\n\t */\n\t( function( container ) {\n\t\tvar touchStartFn, i,\n\t\t\tparentLink = container.querySelectorAll( '.menu-item-has-children > a, .page_item_has_children > a' );\n\n\t\tif ( 'ontouchstart' in window ) {\n\t\t\ttouchStartFn = function( e ) {\n\t\t\t\tvar menuItem = this.parentNode, i;\n\n\t\t\t\tif ( ! menuItem.classList.contains( 'focus' ) ) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tfor ( i = 0; i < menuItem.parentNode.children.length; ++i ) {\n\t\t\t\t\t\tif ( menuItem === menuItem.parentNode.children[i] ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmenuItem.parentNode.children[i].classList.remove( 'focus' );\n\t\t\t\t\t}\n\t\t\t\t\tmenuItem.classList.add( 'focus' );\n\t\t\t\t} else {\n\t\t\t\t\tmenuItem.classList.remove( 'focus' );\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tfor ( i = 0; i < parentLink.length; ++i ) {\n\t\t\t\tparentLink[i].addEventListener( 'touchstart', touchStartFn, false );\n\t\t\t}\n\t\t}\n\t}( container ) );\n} )();\n","// passive listener\njQuery.event.special.touchstart = {\n  setup: function( _, ns, handle ){\n    this.addEventListener(\"touchstart\", handle, { passive: true });\n  }\n};\n\n// rolling start!\n$(document).ready(function($){\n  if ('ontouchstart' in window || 'ontouch' in window) {\n    $('body').addClass('touch');\n  }\n\n  // hamburger action\n  $('.hamburger').click(function(){\n    $(this).toggleClass('is-active');\n    $('body').toggleClass('menu-active');\n  });\n\n  if ($('body.page-template-template-mallbrawl').length) {\n    //initiate fullpage scroll lib\n    $('#fullpage').fullpage({\n      licenseKey: '3F47B661-AE1141D8-AA4CE050-2E2E33BB',\n      //options here\n      // anchors: paginate_urls,\n      autoScrolling:true,\n      scrollOverflow:true,\n      scrollHorizontally: false,\n      verticalCentered: true,\n      navigation: true,\n      navigationPosition: 'right',\n\n      // auto play the video when section is back in view\n      afterLoad: function(){\n        var loadedSection = this;\n        var vid = $('.active').find('video');\n        if (vid.length > 0) {\n          $(vid)[0].play();\n        }\n      },\n    });\n  }\n\n  $('.gallery').each(function() { // the containers for all your galleries\n    $(this).magnificPopup({\n      delegate: 'a', // the selector for gallery item\n      type: 'image',\n      gallery: {\n        enabled: true,\n        navigateByImgClick: true,\n        preload: [0,1] // Will preload 0 - before current, and 1 after the current image\n      },\n      image: {\n        tError: '<a href=\"%url%\">The image #%curr%</a> could not be loaded.',\n        /*titleSrc: function(item) {\n          return item.el.attr('title') + '<small>by Marsel Van Oosten</small>';\n        }*/\n      }\n    });\n  });\n\n  $('.modal-video').magnificPopup({\n    type: 'iframe',\n    mainClass: 'mfp-fade',\n    removalDelay: 160,\n    preloader: false,\n    fixedContentPos: false\n  });\n\n  $('.play-trailer').magnificPopup({\n    type: 'iframe',\n    mainClass: 'mfp-fade',\n    removalDelay: 160,\n    preloader: false,\n    fixedContentPos: false,\n\n    callbacks: {\n      open: function() {\n        // Will fire when this exact popup is opened\n        // this - is Magnific Popup object\n        var vid = $('.screen-one').find('video');\n        if (vid.length > 0) {\n          $(vid)[0].pause();\n        }\n      },\n      close: function() {\n        // Will fire when popup is closed\n        var vid = $('.screen-one').find('video');\n        if (vid.length > 0) {\n          $(vid)[0].play();\n        }\n      }\n    }\n  });\n\n  // Smooth scroll internal hash links\n  // Select all links with hashes\n  $('a[href*=\"#\"]')\n  // Remove links that don't actually link to anything\n  .not('[href=\"#\"]')\n  .not('[href=\"#0\"]')\n  .click(function(event) {\n    // On-page links\n    if (\n      location.pathname.replace(/^\\//, '') == this.pathname.replace(/^\\//, '') \n      && \n      location.hostname == this.hostname\n    ) {\n      // Figure out element to scroll to\n      var target = $(this.hash);\n      target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');\n      // Does a scroll target exist?\n      if (target.length) {\n        // Only prevent default if animation is actually gonna happen\n        event.preventDefault();\n        $('html, body').animate({\n          scrollTop: target.offset().top\n        }, 1000, function() {\n          // Callback after animation\n          // Must change focus!\n          var $target = $(target);\n          $target.focus();\n          if ($target.is(\":focus\")) { // Checking if the target was focused\n            return false;\n          } else {\n            $target.attr('tabindex','-1'); // Adding tabindex for elements not focusable\n            $target.focus(); // Set focus again\n          };\n        });\n      }\n    }\n  });\n});","/**\n * File skip-link-focus-fix.js.\n *\n * Helps with accessibility for keyboard only users.\n *\n * Learn more: https://git.io/vWdr2\n */\n( function() {\n\tvar isIe = /(trident|msie)/i.test( navigator.userAgent );\n\n\tif ( isIe && document.getElementById && window.addEventListener ) {\n\t\twindow.addEventListener( 'hashchange', function() {\n\t\t\tvar id = location.hash.substring( 1 ),\n\t\t\t\telement;\n\n\t\t\tif ( ! ( /^[A-z0-9_-]+$/.test( id ) ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement = document.getElementById( id );\n\n\t\t\tif ( element ) {\n\t\t\t\tif ( ! ( /^(?:a|select|input|button|textarea)$/i.test( element.tagName ) ) ) {\n\t\t\t\t\telement.tabIndex = -1;\n\t\t\t\t}\n\n\t\t\t\telement.focus();\n\t\t\t}\n\t\t}, false );\n\t}\n} )();\n","/**\n * Object Fit Videos\n * Polyfill for object-fit and object-position CSS properties on video elements\n * Covers IE9, IE10, IE11, Edge, Safari <10\n *\n * Usage\n * In your CSS, add a special font-family tag for IE/Edge\n * video {\n *   object-fit: cover;\n *   font-family: 'object-fit: cover;';\n * }\n *\n * Before the closing body tag, or whenever the DOM is ready,\n * make the JavaScript call\n * objectFitVideos();\n *\n * All video elements with the special CSS property will be targeted\n *\n * @license  MIT (https://opensource.org/licenses/MIT)\n * @author   Todd Miller <todd.miller@tricomb2b.com>\n * @version  1.0.2\n * @changelog\n * 2016-08-19 - Adds object-position support.\n * 2016-08-19 - Add throttle function for more performant resize events\n * 2016-08-19 - Initial release with object-fit support, and\n *              object-position default 'center'\n * 2016-10-14 - No longer relies on window load event, instead requires a specific\n *              function call to initialize the videos for object fit and position.\n * 2016-11-28 - Support CommonJS environment, courtesy of @msorensson\n * 2016-12-05 - Refactors the throttling function to support IE\n * 2017-09-26 - Fix an issue with autplay not working on polyfilled videos\n *            - Adds the capability to specify elements to polyfill,\n *              instead of just checking every video element for the\n *              CSS property. Slight performance gain in most usecases,\n *              and a bigger gain in a few usecases.\n * 2017-10-24 - Add user agent check to enable polyfill for all Edge browsers.\n *              object-fit is supported on Edge >= 16, but currently just for images.\n */\nvar objectFitVideos = function (videos) {\n  'use strict';\n\n  var isEdge = navigator.userAgent.indexOf('Edge/') >= 0;\n\n  var testImg                = new Image(),\n      supportsObjectFit      = 'object-fit' in testImg.style && !isEdge,\n      supportsObjectPosition = 'object-position' in testImg.style && !isEdge,\n      propRegex              = /(object-fit|object-position)\\s*:\\s*([-\\w\\s%]+)/g;\n\n  if (!supportsObjectFit || !supportsObjectPosition) {\n    initialize(videos);\n    throttle('resize', 'optimizedResize');\n  }\n\n  /**\n   * Parse the style and look for the special font-family tag\n   * @param  {object} $el The element to parse\n   * @return {object}     The font-family properties we're interested in\n   */\n  function getStyle ($el) {\n    var style  = getComputedStyle($el).fontFamily,\n        parsed = null,\n        props  = {};\n\n      while ((parsed = propRegex.exec(style)) !== null) {\n        props[parsed[1]] = parsed[2];\n      }\n\n      if (props['object-position'])\n        return parsePosition(props);\n\n      return props;\n  }\n\n  /**\n   * Initialize all the relevant video elements and get them fitted\n   */\n  function initialize (videos) {\n    var index = -1;\n\n    if (!videos) {\n      // if no videos given, query all video elements\n      videos = document.querySelectorAll('video');\n    } else if (!('length' in videos)) {\n      // convert to an array for proper looping if an array or NodeList\n      // was not given\n      videos = [videos];\n    }\n\n    while (videos[++index]) {\n      var style = getStyle(videos[index]);\n\n      // only do work if the property is on the element\n      if (style['object-fit'] || style['object-position']) {\n        // set the default values\n        style['object-fit'] = style['object-fit'] || 'fill';\n        fitIt(videos[index], style);\n      }\n    }\n  }\n\n  /**\n   * Object Fit\n   * @param  {object} $el Element to fit\n   * @return {object}     The element's relevant properties\n   */\n  function fitIt ($el, style) {\n    // fill is the default behavior, no action is necessary\n    if (style['object-fit'] === 'fill')\n      return;\n\n    // convenience style properties on the source element\n    var setCss = $el.style,\n        getCss = window.getComputedStyle($el);\n\n    // create and insert a wrapper element\n    var $wrap = document.createElement('object-fit');\n    $wrap.appendChild($el.parentNode.replaceChild($wrap, $el));\n\n    // style the wrapper element to mostly match the source element\n    var wrapCss = {\n      height:    '100%',\n      width:     '100%',\n      boxSizing: 'content-box',\n      display:   'inline-block',\n      overflow:  'hidden'\n    };\n\n    'backgroundColor backgroundImage borderColor borderStyle borderWidth bottom fontSize lineHeight left opacity margin position right top visibility'.replace(/\\w+/g, function (key) {\n      wrapCss[key] = getCss[key];\n    });\n\n    for (var key in wrapCss)\n      $wrap.style[key] = wrapCss[key];\n\n    // give the source element some saner styles\n    setCss.border  = setCss.margin = setCss.padding = 0;\n    setCss.display = 'block';\n    setCss.opacity = 1;\n\n    // set up the event handlers\n    $el.addEventListener('loadedmetadata', doWork);\n    window.addEventListener('optimizedResize', doWork);\n\n    // we may have missed the loadedmetadata event, so if the video has loaded\n    // enough data, just drop the event listener and execute\n    if ($el.readyState >= 1) {\n      $el.removeEventListener('loadedmetadata', doWork);\n      doWork();\n    }\n\n    /**\n     * Do the actual sizing. Math.\n     * @methodOf fitIt\n     */\n    function doWork () {\n      // the actual size and ratio of the video\n      // we do this here, even though it doesn't change, because\n      // at this point we can be sure the metadata has loaded\n      var videoWidth  = $el.videoWidth,\n          videoHeight = $el.videoHeight,\n          videoRatio  = videoWidth / videoHeight;\n\n      var wrapWidth  = $wrap.clientWidth,\n          wrapHeight = $wrap.clientHeight,\n          wrapRatio  = wrapWidth / wrapHeight;\n\n      var newHeight = 0,\n          newWidth  = 0;\n      setCss.marginLeft = setCss.marginTop = 0;\n\n      // basically we do the opposite action for contain and cover,\n      // depending on whether the video aspect ratio is less than or\n      // greater than the wrapper's aspect ratio\n      if (videoRatio < wrapRatio ?\n          style['object-fit'] === 'contain' : style['object-fit'] === 'cover') {\n        newHeight = wrapHeight * videoRatio;\n        newWidth  = wrapWidth / videoRatio;\n\n        setCss.width  = Math.round(newHeight) + 'px';\n        setCss.height = wrapHeight + 'px';\n\n        if (style['object-position-x'] === 'left')\n          setCss.marginLeft = 0;\n        else if (style['object-position-x'] === 'right')\n          setCss.marginLeft = Math.round(wrapWidth - newHeight) + 'px';\n        else\n          setCss.marginLeft = Math.round((wrapWidth - newHeight) / 2) + 'px';\n      } else {\n        newWidth = wrapWidth / videoRatio;\n\n        setCss.width     = wrapWidth + 'px';\n        setCss.height    = Math.round(newWidth) + 'px';\n\n        if (style['object-position-y'] === 'top')\n          setCss.marginTop = 0;\n        else if (style['object-position-y'] === 'bottom')\n          setCss.marginTop = Math.round(wrapHeight - newWidth) + 'px';\n        else\n          setCss.marginTop = Math.round((wrapHeight - newWidth) / 2) + 'px';\n      }\n\n      // play the video if autoplay is set\n      if ($el.autoplay)\n        $el.play();\n    }\n  }\n\n  /**\n   * Split the object-position property into x and y position properties\n   * @param  {object} style Relevant element styles\n   * @return {object}       The style object with the added x and y props\n   */\n  function parsePosition (style) {\n    if (~style['object-position'].indexOf('left'))\n      style['object-position-x'] = 'left';\n    else if (~style['object-position'].indexOf('right'))\n      style['object-position-x'] = 'right';\n    else\n      style['object-position-x'] = 'center';\n\n    if (~style['object-position'].indexOf('top'))\n      style['object-position-y'] = 'top';\n    else if (~style['object-position'].indexOf('bottom'))\n      style['object-position-y'] = 'bottom';\n    else\n      style['object-position-y'] = 'center';\n\n    return style;\n  }\n\n  /**\n   * Throttle an event with RequestAnimationFrame API for better performance\n   * @param  {string} type The event to throttle\n   * @param  {string} name Custom event name to listen for\n   * @param  {object} obj  Optional object to attach the event to\n   */\n  function throttle (type, name, obj) {\n    obj = obj || window;\n    var running = false,\n        evt     = null;\n\n    // IE does not support the CustomEvent constructor\n    // so if that fails do it the old way\n    try {\n      evt = new CustomEvent(name);\n    } catch (e) {\n      evt = document.createEvent('Event');\n      evt.initEvent(name, true, true);\n    }\n\n    var func = function () {\n      if (running) return;\n\n      running = true;\n      requestAnimationFrame(function () {\n        obj.dispatchEvent(evt);\n        running = false;\n      });\n    };\n\n    obj.addEventListener(type, func);\n  }\n};\n\nif (typeof module !== 'undefined' && typeof module.exports !== 'undefined')\n  module.exports = objectFitVideos;\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9tYWluLmpzIiwianMvbW9kZXJuaXpyLXdlYnAuanMiLCJqcy9uYXZpZ2F0aW9uLmpzIiwianMvc2NyaXB0cy5qcyIsImpzL3NraXAtbGluay1mb2N1cy1maXguanMiLCJqcy92ZW5kb3Ivb2JqZWN0LWZpdC12aWRlb3MuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsInJlcXVpcmUoJy4vbW9kZXJuaXpyLXdlYnAnKTtcbnJlcXVpcmUoJy4vdmVuZG9yL29iamVjdC1maXQtdmlkZW9zJyk7XG5cbnJlcXVpcmUoJy4vbmF2aWdhdGlvbicpO1xucmVxdWlyZSgnLi9za2lwLWxpbmstZm9jdXMtZml4Jyk7XG5yZXF1aXJlKCcuL3NjcmlwdHMnKTtcbiIsIi8qISBtb2Rlcm5penIgMy42LjAgKEN1c3RvbSBCdWlsZCkgfCBNSVQgKlxuICogaHR0cHM6Ly9tb2Rlcm5penIuY29tL2Rvd25sb2FkLz8td2VicC1zZXRjbGFzc2VzICEqL1xuIWZ1bmN0aW9uKGUsbixBKXtmdW5jdGlvbiBvKGUpe3ZhciBuPXIuY2xhc3NOYW1lLEE9TW9kZXJuaXpyLl9jb25maWcuY2xhc3NQcmVmaXh8fFwiXCI7aWYobCYmKG49bi5iYXNlVmFsKSxNb2Rlcm5penIuX2NvbmZpZy5lbmFibGVKU0NsYXNzKXt2YXIgbz1uZXcgUmVnRXhwKFwiKF58XFxcXHMpXCIrQStcIm5vLWpzKFxcXFxzfCQpXCIpO249bi5yZXBsYWNlKG8sXCIkMVwiK0ErXCJqcyQyXCIpfU1vZGVybml6ci5fY29uZmlnLmVuYWJsZUNsYXNzZXMmJihuKz1cIiBcIitBK2Uuam9pbihcIiBcIitBKSxsP3IuY2xhc3NOYW1lLmJhc2VWYWw9bjpyLmNsYXNzTmFtZT1uKX1mdW5jdGlvbiB0KGUsbil7cmV0dXJuIHR5cGVvZiBlPT09bn1mdW5jdGlvbiBhKCl7dmFyIGUsbixBLG8sYSxpLHI7Zm9yKHZhciBsIGluIGYpaWYoZi5oYXNPd25Qcm9wZXJ0eShsKSl7aWYoZT1bXSxuPWZbbF0sbi5uYW1lJiYoZS5wdXNoKG4ubmFtZS50b0xvd2VyQ2FzZSgpKSxuLm9wdGlvbnMmJm4ub3B0aW9ucy5hbGlhc2VzJiZuLm9wdGlvbnMuYWxpYXNlcy5sZW5ndGgpKWZvcihBPTA7QTxuLm9wdGlvbnMuYWxpYXNlcy5sZW5ndGg7QSsrKWUucHVzaChuLm9wdGlvbnMuYWxpYXNlc1tBXS50b0xvd2VyQ2FzZSgpKTtmb3Iobz10KG4uZm4sXCJmdW5jdGlvblwiKT9uLmZuKCk6bi5mbixhPTA7YTxlLmxlbmd0aDthKyspaT1lW2FdLHI9aS5zcGxpdChcIi5cIiksMT09PXIubGVuZ3RoP01vZGVybml6cltyWzBdXT1vOighTW9kZXJuaXpyW3JbMF1dfHxNb2Rlcm5penJbclswXV1pbnN0YW5jZW9mIEJvb2xlYW58fChNb2Rlcm5penJbclswXV09bmV3IEJvb2xlYW4oTW9kZXJuaXpyW3JbMF1dKSksTW9kZXJuaXpyW3JbMF1dW3JbMV1dPW8pLHMucHVzaCgobz9cIlwiOlwibm8tXCIpK3Iuam9pbihcIi1cIikpfX1mdW5jdGlvbiBpKGUsbil7aWYoXCJvYmplY3RcIj09dHlwZW9mIGUpZm9yKHZhciBBIGluIGUpYyhlLEEpJiZpKEEsZVtBXSk7ZWxzZXtlPWUudG9Mb3dlckNhc2UoKTt2YXIgdD1lLnNwbGl0KFwiLlwiKSxhPU1vZGVybml6clt0WzBdXTtpZigyPT10Lmxlbmd0aCYmKGE9YVt0WzFdXSksXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGEpcmV0dXJuIE1vZGVybml6cjtuPVwiZnVuY3Rpb25cIj09dHlwZW9mIG4/bigpOm4sMT09dC5sZW5ndGg/TW9kZXJuaXpyW3RbMF1dPW46KCFNb2Rlcm5penJbdFswXV18fE1vZGVybml6clt0WzBdXWluc3RhbmNlb2YgQm9vbGVhbnx8KE1vZGVybml6clt0WzBdXT1uZXcgQm9vbGVhbihNb2Rlcm5penJbdFswXV0pKSxNb2Rlcm5penJbdFswXV1bdFsxXV09biksbyhbKG4mJjAhPW4/XCJcIjpcIm5vLVwiKSt0LmpvaW4oXCItXCIpXSksTW9kZXJuaXpyLl90cmlnZ2VyKGUsbil9cmV0dXJuIE1vZGVybml6cn12YXIgcz1bXSxyPW4uZG9jdW1lbnRFbGVtZW50LGw9XCJzdmdcIj09PXIubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxmPVtdLHU9e192ZXJzaW9uOlwiMy42LjBcIixfY29uZmlnOntjbGFzc1ByZWZpeDpcIlwiLGVuYWJsZUNsYXNzZXM6ITAsZW5hYmxlSlNDbGFzczohMCx1c2VQcmVmaXhlczohMH0sX3E6W10sb246ZnVuY3Rpb24oZSxuKXt2YXIgQT10aGlzO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtuKEFbZV0pfSwwKX0sYWRkVGVzdDpmdW5jdGlvbihlLG4sQSl7Zi5wdXNoKHtuYW1lOmUsZm46bixvcHRpb25zOkF9KX0sYWRkQXN5bmNUZXN0OmZ1bmN0aW9uKGUpe2YucHVzaCh7bmFtZTpudWxsLGZuOmV9KX19LE1vZGVybml6cj1mdW5jdGlvbigpe307TW9kZXJuaXpyLnByb3RvdHlwZT11LE1vZGVybml6cj1uZXcgTW9kZXJuaXpyO3ZhciBjOyFmdW5jdGlvbigpe3ZhciBlPXt9Lmhhc093blByb3BlcnR5O2M9dChlLFwidW5kZWZpbmVkXCIpfHx0KGUuY2FsbCxcInVuZGVmaW5lZFwiKT9mdW5jdGlvbihlLG4pe3JldHVybiBuIGluIGUmJnQoZS5jb25zdHJ1Y3Rvci5wcm90b3R5cGVbbl0sXCJ1bmRlZmluZWRcIil9OmZ1bmN0aW9uKG4sQSl7cmV0dXJuIGUuY2FsbChuLEEpfX0oKSx1Ll9sPXt9LHUub249ZnVuY3Rpb24oZSxuKXt0aGlzLl9sW2VdfHwodGhpcy5fbFtlXT1bXSksdGhpcy5fbFtlXS5wdXNoKG4pLE1vZGVybml6ci5oYXNPd25Qcm9wZXJ0eShlKSYmc2V0VGltZW91dChmdW5jdGlvbigpe01vZGVybml6ci5fdHJpZ2dlcihlLE1vZGVybml6cltlXSl9LDApfSx1Ll90cmlnZ2VyPWZ1bmN0aW9uKGUsbil7aWYodGhpcy5fbFtlXSl7dmFyIEE9dGhpcy5fbFtlXTtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dmFyIGUsbztmb3IoZT0wO2U8QS5sZW5ndGg7ZSsrKShvPUFbZV0pKG4pfSwwKSxkZWxldGUgdGhpcy5fbFtlXX19LE1vZGVybml6ci5fcS5wdXNoKGZ1bmN0aW9uKCl7dS5hZGRUZXN0PWl9KSxNb2Rlcm5penIuYWRkQXN5bmNUZXN0KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLG4sQSl7ZnVuY3Rpb24gbyhuKXt2YXIgbz1uJiZcImxvYWRcIj09PW4udHlwZT8xPT10LndpZHRoOiExLGE9XCJ3ZWJwXCI9PT1lO2koZSxhJiZvP25ldyBCb29sZWFuKG8pOm8pLEEmJkEobil9dmFyIHQ9bmV3IEltYWdlO3Qub25lcnJvcj1vLHQub25sb2FkPW8sdC5zcmM9bn12YXIgbj1be3VyaTpcImRhdGE6aW1hZ2Uvd2VicDtiYXNlNjQsVWtsR1JpUUFBQUJYUlVKUVZsQTRJQmdBQUFBd0FRQ2RBU29CQUFFQUF3QTBKYVFBQTNBQS92dVVBQUE9XCIsbmFtZTpcIndlYnBcIn0se3VyaTpcImRhdGE6aW1hZ2Uvd2VicDtiYXNlNjQsVWtsR1Jrb0FBQUJYUlVKUVZsQTRXQW9BQUFBUUFBQUFBQUFBQUFBQVFVeFFTQXdBQUFBQkJ4QVIvUTlFUlA4REFBQldVRGdnR0FBQUFEQUJBSjBCS2dFQUFRQURBRFFscEFBRGNBRCsrLzFRQUE9PVwiLG5hbWU6XCJ3ZWJwLmFscGhhXCJ9LHt1cmk6XCJkYXRhOmltYWdlL3dlYnA7YmFzZTY0LFVrbEdSbElBQUFCWFJVSlFWbEE0V0FvQUFBQVNBQUFBQUFBQUFBQUFRVTVKVFFZQUFBRC8vLy8vQUFCQlRrMUdKZ0FBQUFBQUFBQUFBQUFBQUFBQUFHUUFBQUJXVURoTURRQUFBQzhBQUFBUUJ4QVJFWWlJL2djQVwiLG5hbWU6XCJ3ZWJwLmFuaW1hdGlvblwifSx7dXJpOlwiZGF0YTppbWFnZS93ZWJwO2Jhc2U2NCxVa2xHUmg0QUFBQlhSVUpRVmxBNFRCRUFBQUF2QUFBQUFBZlEvLzczdi8rQmlPaC9BQUE9XCIsbmFtZTpcIndlYnAubG9zc2xlc3NcIn1dLEE9bi5zaGlmdCgpO2UoQS5uYW1lLEEudXJpLGZ1bmN0aW9uKEEpe2lmKEEmJlwibG9hZFwiPT09QS50eXBlKWZvcih2YXIgbz0wO288bi5sZW5ndGg7bysrKWUobltvXS5uYW1lLG5bb10udXJpKX0pfSksYSgpLG8ocyksZGVsZXRlIHUuYWRkVGVzdCxkZWxldGUgdS5hZGRBc3luY1Rlc3Q7Zm9yKHZhciBwPTA7cDxNb2Rlcm5penIuX3EubGVuZ3RoO3ArKylNb2Rlcm5penIuX3FbcF0oKTtlLk1vZGVybml6cj1Nb2Rlcm5penJ9KHdpbmRvdyxkb2N1bWVudCk7IiwiLyoqXG4gKiBGaWxlIG5hdmlnYXRpb24uanMuXG4gKlxuICogSGFuZGxlcyB0b2dnbGluZyB0aGUgbmF2aWdhdGlvbiBtZW51IGZvciBzbWFsbCBzY3JlZW5zIGFuZCBlbmFibGVzIFRBQiBrZXlcbiAqIG5hdmlnYXRpb24gc3VwcG9ydCBmb3IgZHJvcGRvd24gbWVudXMuXG4gKi9cbiggZnVuY3Rpb24oKSB7XG5cdHZhciBjb250YWluZXIsIGJ1dHRvbiwgbWVudSwgbGlua3MsIGksIGxlbjtcblxuXHRjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggJ3NpdGUtbmF2aWdhdGlvbicgKTtcblx0aWYgKCAhIGNvbnRhaW5lciApIHtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRidXR0b24gPSBjb250YWluZXIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoICdidXR0b24nIClbMF07XG5cdGlmICggJ3VuZGVmaW5lZCcgPT09IHR5cGVvZiBidXR0b24gKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0bWVudSA9IGNvbnRhaW5lci5nZXRFbGVtZW50c0J5VGFnTmFtZSggJ3VsJyApWzBdO1xuXG5cdC8vIEhpZGUgbWVudSB0b2dnbGUgYnV0dG9uIGlmIG1lbnUgaXMgZW1wdHkgYW5kIHJldHVybiBlYXJseS5cblx0aWYgKCAndW5kZWZpbmVkJyA9PT0gdHlwZW9mIG1lbnUgKSB7XG5cdFx0YnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0bWVudS5zZXRBdHRyaWJ1dGUoICdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyApO1xuXHRpZiAoIC0xID09PSBtZW51LmNsYXNzTmFtZS5pbmRleE9mKCAnbmF2LW1lbnUnICkgKSB7XG5cdFx0bWVudS5jbGFzc05hbWUgKz0gJyBuYXYtbWVudSc7XG5cdH1cblxuXHRidXR0b24ub25jbGljayA9IGZ1bmN0aW9uKCkge1xuXHRcdGlmICggLTEgIT09IGNvbnRhaW5lci5jbGFzc05hbWUuaW5kZXhPZiggJ3RvZ2dsZWQnICkgKSB7XG5cdFx0XHRjb250YWluZXIuY2xhc3NOYW1lID0gY29udGFpbmVyLmNsYXNzTmFtZS5yZXBsYWNlKCAnIHRvZ2dsZWQnLCAnJyApO1xuXHRcdFx0YnV0dG9uLnNldEF0dHJpYnV0ZSggJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnICk7XG5cdFx0XHRtZW51LnNldEF0dHJpYnV0ZSggJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnRhaW5lci5jbGFzc05hbWUgKz0gJyB0b2dnbGVkJztcblx0XHRcdGJ1dHRvbi5zZXRBdHRyaWJ1dGUoICdhcmlhLWV4cGFuZGVkJywgJ3RydWUnICk7XG5cdFx0XHRtZW51LnNldEF0dHJpYnV0ZSggJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScgKTtcblx0XHR9XG5cdH07XG5cblx0Ly8gR2V0IGFsbCB0aGUgbGluayBlbGVtZW50cyB3aXRoaW4gdGhlIG1lbnUuXG5cdGxpbmtzICAgID0gbWVudS5nZXRFbGVtZW50c0J5VGFnTmFtZSggJ2EnICk7XG5cblx0Ly8gRWFjaCB0aW1lIGEgbWVudSBsaW5rIGlzIGZvY3VzZWQgb3IgYmx1cnJlZCwgdG9nZ2xlIGZvY3VzLlxuXHRmb3IgKCBpID0gMCwgbGVuID0gbGlua3MubGVuZ3RoOyBpIDwgbGVuOyBpKysgKSB7XG5cdFx0bGlua3NbaV0uYWRkRXZlbnRMaXN0ZW5lciggJ2ZvY3VzJywgdG9nZ2xlRm9jdXMsIHRydWUgKTtcblx0XHRsaW5rc1tpXS5hZGRFdmVudExpc3RlbmVyKCAnYmx1cicsIHRvZ2dsZUZvY3VzLCB0cnVlICk7XG5cdH1cblxuXHQvKipcblx0ICogU2V0cyBvciByZW1vdmVzIC5mb2N1cyBjbGFzcyBvbiBhbiBlbGVtZW50LlxuXHQgKi9cblx0ZnVuY3Rpb24gdG9nZ2xlRm9jdXMoKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0Ly8gTW92ZSB1cCB0aHJvdWdoIHRoZSBhbmNlc3RvcnMgb2YgdGhlIGN1cnJlbnQgbGluayB1bnRpbCB3ZSBoaXQgLm5hdi1tZW51LlxuXHRcdHdoaWxlICggLTEgPT09IHNlbGYuY2xhc3NOYW1lLmluZGV4T2YoICduYXYtbWVudScgKSApIHtcblxuXHRcdFx0Ly8gT24gbGkgZWxlbWVudHMgdG9nZ2xlIHRoZSBjbGFzcyAuZm9jdXMuXG5cdFx0XHRpZiAoICdsaScgPT09IHNlbGYudGFnTmFtZS50b0xvd2VyQ2FzZSgpICkge1xuXHRcdFx0XHRpZiAoIC0xICE9PSBzZWxmLmNsYXNzTmFtZS5pbmRleE9mKCAnZm9jdXMnICkgKSB7XG5cdFx0XHRcdFx0c2VsZi5jbGFzc05hbWUgPSBzZWxmLmNsYXNzTmFtZS5yZXBsYWNlKCAnIGZvY3VzJywgJycgKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRzZWxmLmNsYXNzTmFtZSArPSAnIGZvY3VzJztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRzZWxmID0gc2VsZi5wYXJlbnRFbGVtZW50O1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBUb2dnbGVzIGBmb2N1c2AgY2xhc3MgdG8gYWxsb3cgc3VibWVudSBhY2Nlc3Mgb24gdGFibGV0cy5cblx0ICovXG5cdCggZnVuY3Rpb24oIGNvbnRhaW5lciApIHtcblx0XHR2YXIgdG91Y2hTdGFydEZuLCBpLFxuXHRcdFx0cGFyZW50TGluayA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCAnLm1lbnUtaXRlbS1oYXMtY2hpbGRyZW4gPiBhLCAucGFnZV9pdGVtX2hhc19jaGlsZHJlbiA+IGEnICk7XG5cblx0XHRpZiAoICdvbnRvdWNoc3RhcnQnIGluIHdpbmRvdyApIHtcblx0XHRcdHRvdWNoU3RhcnRGbiA9IGZ1bmN0aW9uKCBlICkge1xuXHRcdFx0XHR2YXIgbWVudUl0ZW0gPSB0aGlzLnBhcmVudE5vZGUsIGk7XG5cblx0XHRcdFx0aWYgKCAhIG1lbnVJdGVtLmNsYXNzTGlzdC5jb250YWlucyggJ2ZvY3VzJyApICkge1xuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRmb3IgKCBpID0gMDsgaSA8IG1lbnVJdGVtLnBhcmVudE5vZGUuY2hpbGRyZW4ubGVuZ3RoOyArK2kgKSB7XG5cdFx0XHRcdFx0XHRpZiAoIG1lbnVJdGVtID09PSBtZW51SXRlbS5wYXJlbnROb2RlLmNoaWxkcmVuW2ldICkge1xuXHRcdFx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdG1lbnVJdGVtLnBhcmVudE5vZGUuY2hpbGRyZW5baV0uY2xhc3NMaXN0LnJlbW92ZSggJ2ZvY3VzJyApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRtZW51SXRlbS5jbGFzc0xpc3QuYWRkKCAnZm9jdXMnICk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bWVudUl0ZW0uY2xhc3NMaXN0LnJlbW92ZSggJ2ZvY3VzJyApO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0XHRmb3IgKCBpID0gMDsgaSA8IHBhcmVudExpbmsubGVuZ3RoOyArK2kgKSB7XG5cdFx0XHRcdHBhcmVudExpbmtbaV0uYWRkRXZlbnRMaXN0ZW5lciggJ3RvdWNoc3RhcnQnLCB0b3VjaFN0YXJ0Rm4sIGZhbHNlICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KCBjb250YWluZXIgKSApO1xufSApKCk7XG4iLCIvLyBwYXNzaXZlIGxpc3RlbmVyXG5qUXVlcnkuZXZlbnQuc3BlY2lhbC50b3VjaHN0YXJ0ID0ge1xuICBzZXR1cDogZnVuY3Rpb24oIF8sIG5zLCBoYW5kbGUgKXtcbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIGhhbmRsZSwgeyBwYXNzaXZlOiB0cnVlIH0pO1xuICB9XG59O1xuXG4vLyByb2xsaW5nIHN0YXJ0IVxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oJCl7XG4gIGlmICgnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cgfHwgJ29udG91Y2gnIGluIHdpbmRvdykge1xuICAgICQoJ2JvZHknKS5hZGRDbGFzcygndG91Y2gnKTtcbiAgfVxuXG4gIC8vIGhhbWJ1cmdlciBhY3Rpb25cbiAgJCgnLmhhbWJ1cmdlcicpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICAgJCh0aGlzKS50b2dnbGVDbGFzcygnaXMtYWN0aXZlJyk7XG4gICAgJCgnYm9keScpLnRvZ2dsZUNsYXNzKCdtZW51LWFjdGl2ZScpO1xuICB9KTtcblxuICBpZiAoJCgnYm9keS5wYWdlLXRlbXBsYXRlLXRlbXBsYXRlLW1hbGxicmF3bCcpLmxlbmd0aCkge1xuICAgIC8vaW5pdGlhdGUgZnVsbHBhZ2Ugc2Nyb2xsIGxpYlxuICAgICQoJyNmdWxscGFnZScpLmZ1bGxwYWdlKHtcbiAgICAgIGxpY2Vuc2VLZXk6ICczRjQ3QjY2MS1BRTExNDFEOC1BQTRDRTA1MC0yRTJFMzNCQicsXG4gICAgICAvL29wdGlvbnMgaGVyZVxuICAgICAgLy8gYW5jaG9yczogcGFnaW5hdGVfdXJscyxcbiAgICAgIGF1dG9TY3JvbGxpbmc6dHJ1ZSxcbiAgICAgIHNjcm9sbE92ZXJmbG93OnRydWUsXG4gICAgICBzY3JvbGxIb3Jpem9udGFsbHk6IGZhbHNlLFxuICAgICAgdmVydGljYWxDZW50ZXJlZDogdHJ1ZSxcbiAgICAgIG5hdmlnYXRpb246IHRydWUsXG4gICAgICBuYXZpZ2F0aW9uUG9zaXRpb246ICdyaWdodCcsXG5cbiAgICAgIC8vIGF1dG8gcGxheSB0aGUgdmlkZW8gd2hlbiBzZWN0aW9uIGlzIGJhY2sgaW4gdmlld1xuICAgICAgYWZ0ZXJMb2FkOiBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgbG9hZGVkU2VjdGlvbiA9IHRoaXM7XG4gICAgICAgIHZhciB2aWQgPSAkKCcuYWN0aXZlJykuZmluZCgndmlkZW8nKTtcbiAgICAgICAgaWYgKHZpZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgJCh2aWQpWzBdLnBsYXkoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gICQoJy5nYWxsZXJ5JykuZWFjaChmdW5jdGlvbigpIHsgLy8gdGhlIGNvbnRhaW5lcnMgZm9yIGFsbCB5b3VyIGdhbGxlcmllc1xuICAgICQodGhpcykubWFnbmlmaWNQb3B1cCh7XG4gICAgICBkZWxlZ2F0ZTogJ2EnLCAvLyB0aGUgc2VsZWN0b3IgZm9yIGdhbGxlcnkgaXRlbVxuICAgICAgdHlwZTogJ2ltYWdlJyxcbiAgICAgIGdhbGxlcnk6IHtcbiAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgbmF2aWdhdGVCeUltZ0NsaWNrOiB0cnVlLFxuICAgICAgICBwcmVsb2FkOiBbMCwxXSAvLyBXaWxsIHByZWxvYWQgMCAtIGJlZm9yZSBjdXJyZW50LCBhbmQgMSBhZnRlciB0aGUgY3VycmVudCBpbWFnZVxuICAgICAgfSxcbiAgICAgIGltYWdlOiB7XG4gICAgICAgIHRFcnJvcjogJzxhIGhyZWY9XCIldXJsJVwiPlRoZSBpbWFnZSAjJWN1cnIlPC9hPiBjb3VsZCBub3QgYmUgbG9hZGVkLicsXG4gICAgICAgIC8qdGl0bGVTcmM6IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICByZXR1cm4gaXRlbS5lbC5hdHRyKCd0aXRsZScpICsgJzxzbWFsbD5ieSBNYXJzZWwgVmFuIE9vc3Rlbjwvc21hbGw+JztcbiAgICAgICAgfSovXG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gICQoJy5tb2RhbC12aWRlbycpLm1hZ25pZmljUG9wdXAoe1xuICAgIHR5cGU6ICdpZnJhbWUnLFxuICAgIG1haW5DbGFzczogJ21mcC1mYWRlJyxcbiAgICByZW1vdmFsRGVsYXk6IDE2MCxcbiAgICBwcmVsb2FkZXI6IGZhbHNlLFxuICAgIGZpeGVkQ29udGVudFBvczogZmFsc2VcbiAgfSk7XG5cbiAgJCgnLnBsYXktdHJhaWxlcicpLm1hZ25pZmljUG9wdXAoe1xuICAgIHR5cGU6ICdpZnJhbWUnLFxuICAgIG1haW5DbGFzczogJ21mcC1mYWRlJyxcbiAgICByZW1vdmFsRGVsYXk6IDE2MCxcbiAgICBwcmVsb2FkZXI6IGZhbHNlLFxuICAgIGZpeGVkQ29udGVudFBvczogZmFsc2UsXG5cbiAgICBjYWxsYmFja3M6IHtcbiAgICAgIG9wZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBXaWxsIGZpcmUgd2hlbiB0aGlzIGV4YWN0IHBvcHVwIGlzIG9wZW5lZFxuICAgICAgICAvLyB0aGlzIC0gaXMgTWFnbmlmaWMgUG9wdXAgb2JqZWN0XG4gICAgICAgIHZhciB2aWQgPSAkKCcuc2NyZWVuLW9uZScpLmZpbmQoJ3ZpZGVvJyk7XG4gICAgICAgIGlmICh2aWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICQodmlkKVswXS5wYXVzZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgY2xvc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBXaWxsIGZpcmUgd2hlbiBwb3B1cCBpcyBjbG9zZWRcbiAgICAgICAgdmFyIHZpZCA9ICQoJy5zY3JlZW4tb25lJykuZmluZCgndmlkZW8nKTtcbiAgICAgICAgaWYgKHZpZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgJCh2aWQpWzBdLnBsYXkoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgLy8gU21vb3RoIHNjcm9sbCBpbnRlcm5hbCBoYXNoIGxpbmtzXG4gIC8vIFNlbGVjdCBhbGwgbGlua3Mgd2l0aCBoYXNoZXNcbiAgJCgnYVtocmVmKj1cIiNcIl0nKVxuICAvLyBSZW1vdmUgbGlua3MgdGhhdCBkb24ndCBhY3R1YWxseSBsaW5rIHRvIGFueXRoaW5nXG4gIC5ub3QoJ1tocmVmPVwiI1wiXScpXG4gIC5ub3QoJ1tocmVmPVwiIzBcIl0nKVxuICAuY2xpY2soZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAvLyBPbi1wYWdlIGxpbmtzXG4gICAgaWYgKFxuICAgICAgbG9jYXRpb24ucGF0aG5hbWUucmVwbGFjZSgvXlxcLy8sICcnKSA9PSB0aGlzLnBhdGhuYW1lLnJlcGxhY2UoL15cXC8vLCAnJykgXG4gICAgICAmJiBcbiAgICAgIGxvY2F0aW9uLmhvc3RuYW1lID09IHRoaXMuaG9zdG5hbWVcbiAgICApIHtcbiAgICAgIC8vIEZpZ3VyZSBvdXQgZWxlbWVudCB0byBzY3JvbGwgdG9cbiAgICAgIHZhciB0YXJnZXQgPSAkKHRoaXMuaGFzaCk7XG4gICAgICB0YXJnZXQgPSB0YXJnZXQubGVuZ3RoID8gdGFyZ2V0IDogJCgnW25hbWU9JyArIHRoaXMuaGFzaC5zbGljZSgxKSArICddJyk7XG4gICAgICAvLyBEb2VzIGEgc2Nyb2xsIHRhcmdldCBleGlzdD9cbiAgICAgIGlmICh0YXJnZXQubGVuZ3RoKSB7XG4gICAgICAgIC8vIE9ubHkgcHJldmVudCBkZWZhdWx0IGlmIGFuaW1hdGlvbiBpcyBhY3R1YWxseSBnb25uYSBoYXBwZW5cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgJCgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xuICAgICAgICAgIHNjcm9sbFRvcDogdGFyZ2V0Lm9mZnNldCgpLnRvcFxuICAgICAgICB9LCAxMDAwLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAvLyBDYWxsYmFjayBhZnRlciBhbmltYXRpb25cbiAgICAgICAgICAvLyBNdXN0IGNoYW5nZSBmb2N1cyFcbiAgICAgICAgICB2YXIgJHRhcmdldCA9ICQodGFyZ2V0KTtcbiAgICAgICAgICAkdGFyZ2V0LmZvY3VzKCk7XG4gICAgICAgICAgaWYgKCR0YXJnZXQuaXMoXCI6Zm9jdXNcIikpIHsgLy8gQ2hlY2tpbmcgaWYgdGhlIHRhcmdldCB3YXMgZm9jdXNlZFxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkdGFyZ2V0LmF0dHIoJ3RhYmluZGV4JywnLTEnKTsgLy8gQWRkaW5nIHRhYmluZGV4IGZvciBlbGVtZW50cyBub3QgZm9jdXNhYmxlXG4gICAgICAgICAgICAkdGFyZ2V0LmZvY3VzKCk7IC8vIFNldCBmb2N1cyBhZ2FpblxuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59KTsiLCIvKipcbiAqIEZpbGUgc2tpcC1saW5rLWZvY3VzLWZpeC5qcy5cbiAqXG4gKiBIZWxwcyB3aXRoIGFjY2Vzc2liaWxpdHkgZm9yIGtleWJvYXJkIG9ubHkgdXNlcnMuXG4gKlxuICogTGVhcm4gbW9yZTogaHR0cHM6Ly9naXQuaW8vdldkcjJcbiAqL1xuKCBmdW5jdGlvbigpIHtcblx0dmFyIGlzSWUgPSAvKHRyaWRlbnR8bXNpZSkvaS50ZXN0KCBuYXZpZ2F0b3IudXNlckFnZW50ICk7XG5cblx0aWYgKCBpc0llICYmIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkICYmIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyICkge1xuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAnaGFzaGNoYW5nZScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGlkID0gbG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoIDEgKSxcblx0XHRcdFx0ZWxlbWVudDtcblxuXHRcdFx0aWYgKCAhICggL15bQS16MC05Xy1dKyQvLnRlc3QoIGlkICkgKSApIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIGlkICk7XG5cblx0XHRcdGlmICggZWxlbWVudCApIHtcblx0XHRcdFx0aWYgKCAhICggL14oPzphfHNlbGVjdHxpbnB1dHxidXR0b258dGV4dGFyZWEpJC9pLnRlc3QoIGVsZW1lbnQudGFnTmFtZSApICkgKSB7XG5cdFx0XHRcdFx0ZWxlbWVudC50YWJJbmRleCA9IC0xO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZWxlbWVudC5mb2N1cygpO1xuXHRcdFx0fVxuXHRcdH0sIGZhbHNlICk7XG5cdH1cbn0gKSgpO1xuIiwiLyoqXG4gKiBPYmplY3QgRml0IFZpZGVvc1xuICogUG9seWZpbGwgZm9yIG9iamVjdC1maXQgYW5kIG9iamVjdC1wb3NpdGlvbiBDU1MgcHJvcGVydGllcyBvbiB2aWRlbyBlbGVtZW50c1xuICogQ292ZXJzIElFOSwgSUUxMCwgSUUxMSwgRWRnZSwgU2FmYXJpIDwxMFxuICpcbiAqIFVzYWdlXG4gKiBJbiB5b3VyIENTUywgYWRkIGEgc3BlY2lhbCBmb250LWZhbWlseSB0YWcgZm9yIElFL0VkZ2VcbiAqIHZpZGVvIHtcbiAqICAgb2JqZWN0LWZpdDogY292ZXI7XG4gKiAgIGZvbnQtZmFtaWx5OiAnb2JqZWN0LWZpdDogY292ZXI7JztcbiAqIH1cbiAqXG4gKiBCZWZvcmUgdGhlIGNsb3NpbmcgYm9keSB0YWcsIG9yIHdoZW5ldmVyIHRoZSBET00gaXMgcmVhZHksXG4gKiBtYWtlIHRoZSBKYXZhU2NyaXB0IGNhbGxcbiAqIG9iamVjdEZpdFZpZGVvcygpO1xuICpcbiAqIEFsbCB2aWRlbyBlbGVtZW50cyB3aXRoIHRoZSBzcGVjaWFsIENTUyBwcm9wZXJ0eSB3aWxsIGJlIHRhcmdldGVkXG4gKlxuICogQGxpY2Vuc2UgIE1JVCAoaHR0cHM6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9NSVQpXG4gKiBAYXV0aG9yICAgVG9kZCBNaWxsZXIgPHRvZGQubWlsbGVyQHRyaWNvbWIyYi5jb20+XG4gKiBAdmVyc2lvbiAgMS4wLjJcbiAqIEBjaGFuZ2Vsb2dcbiAqIDIwMTYtMDgtMTkgLSBBZGRzIG9iamVjdC1wb3NpdGlvbiBzdXBwb3J0LlxuICogMjAxNi0wOC0xOSAtIEFkZCB0aHJvdHRsZSBmdW5jdGlvbiBmb3IgbW9yZSBwZXJmb3JtYW50IHJlc2l6ZSBldmVudHNcbiAqIDIwMTYtMDgtMTkgLSBJbml0aWFsIHJlbGVhc2Ugd2l0aCBvYmplY3QtZml0IHN1cHBvcnQsIGFuZFxuICogICAgICAgICAgICAgIG9iamVjdC1wb3NpdGlvbiBkZWZhdWx0ICdjZW50ZXInXG4gKiAyMDE2LTEwLTE0IC0gTm8gbG9uZ2VyIHJlbGllcyBvbiB3aW5kb3cgbG9hZCBldmVudCwgaW5zdGVhZCByZXF1aXJlcyBhIHNwZWNpZmljXG4gKiAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbCB0byBpbml0aWFsaXplIHRoZSB2aWRlb3MgZm9yIG9iamVjdCBmaXQgYW5kIHBvc2l0aW9uLlxuICogMjAxNi0xMS0yOCAtIFN1cHBvcnQgQ29tbW9uSlMgZW52aXJvbm1lbnQsIGNvdXJ0ZXN5IG9mIEBtc29yZW5zc29uXG4gKiAyMDE2LTEyLTA1IC0gUmVmYWN0b3JzIHRoZSB0aHJvdHRsaW5nIGZ1bmN0aW9uIHRvIHN1cHBvcnQgSUVcbiAqIDIwMTctMDktMjYgLSBGaXggYW4gaXNzdWUgd2l0aCBhdXRwbGF5IG5vdCB3b3JraW5nIG9uIHBvbHlmaWxsZWQgdmlkZW9zXG4gKiAgICAgICAgICAgIC0gQWRkcyB0aGUgY2FwYWJpbGl0eSB0byBzcGVjaWZ5IGVsZW1lbnRzIHRvIHBvbHlmaWxsLFxuICogICAgICAgICAgICAgIGluc3RlYWQgb2YganVzdCBjaGVja2luZyBldmVyeSB2aWRlbyBlbGVtZW50IGZvciB0aGVcbiAqICAgICAgICAgICAgICBDU1MgcHJvcGVydHkuIFNsaWdodCBwZXJmb3JtYW5jZSBnYWluIGluIG1vc3QgdXNlY2FzZXMsXG4gKiAgICAgICAgICAgICAgYW5kIGEgYmlnZ2VyIGdhaW4gaW4gYSBmZXcgdXNlY2FzZXMuXG4gKiAyMDE3LTEwLTI0IC0gQWRkIHVzZXIgYWdlbnQgY2hlY2sgdG8gZW5hYmxlIHBvbHlmaWxsIGZvciBhbGwgRWRnZSBicm93c2Vycy5cbiAqICAgICAgICAgICAgICBvYmplY3QtZml0IGlzIHN1cHBvcnRlZCBvbiBFZGdlID49IDE2LCBidXQgY3VycmVudGx5IGp1c3QgZm9yIGltYWdlcy5cbiAqL1xudmFyIG9iamVjdEZpdFZpZGVvcyA9IGZ1bmN0aW9uICh2aWRlb3MpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHZhciBpc0VkZ2UgPSBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ0VkZ2UvJykgPj0gMDtcblxuICB2YXIgdGVzdEltZyAgICAgICAgICAgICAgICA9IG5ldyBJbWFnZSgpLFxuICAgICAgc3VwcG9ydHNPYmplY3RGaXQgICAgICA9ICdvYmplY3QtZml0JyBpbiB0ZXN0SW1nLnN0eWxlICYmICFpc0VkZ2UsXG4gICAgICBzdXBwb3J0c09iamVjdFBvc2l0aW9uID0gJ29iamVjdC1wb3NpdGlvbicgaW4gdGVzdEltZy5zdHlsZSAmJiAhaXNFZGdlLFxuICAgICAgcHJvcFJlZ2V4ICAgICAgICAgICAgICA9IC8ob2JqZWN0LWZpdHxvYmplY3QtcG9zaXRpb24pXFxzKjpcXHMqKFstXFx3XFxzJV0rKS9nO1xuXG4gIGlmICghc3VwcG9ydHNPYmplY3RGaXQgfHwgIXN1cHBvcnRzT2JqZWN0UG9zaXRpb24pIHtcbiAgICBpbml0aWFsaXplKHZpZGVvcyk7XG4gICAgdGhyb3R0bGUoJ3Jlc2l6ZScsICdvcHRpbWl6ZWRSZXNpemUnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSB0aGUgc3R5bGUgYW5kIGxvb2sgZm9yIHRoZSBzcGVjaWFsIGZvbnQtZmFtaWx5IHRhZ1xuICAgKiBAcGFyYW0gIHtvYmplY3R9ICRlbCBUaGUgZWxlbWVudCB0byBwYXJzZVxuICAgKiBAcmV0dXJuIHtvYmplY3R9ICAgICBUaGUgZm9udC1mYW1pbHkgcHJvcGVydGllcyB3ZSdyZSBpbnRlcmVzdGVkIGluXG4gICAqL1xuICBmdW5jdGlvbiBnZXRTdHlsZSAoJGVsKSB7XG4gICAgdmFyIHN0eWxlICA9IGdldENvbXB1dGVkU3R5bGUoJGVsKS5mb250RmFtaWx5LFxuICAgICAgICBwYXJzZWQgPSBudWxsLFxuICAgICAgICBwcm9wcyAgPSB7fTtcblxuICAgICAgd2hpbGUgKChwYXJzZWQgPSBwcm9wUmVnZXguZXhlYyhzdHlsZSkpICE9PSBudWxsKSB7XG4gICAgICAgIHByb3BzW3BhcnNlZFsxXV0gPSBwYXJzZWRbMl07XG4gICAgICB9XG5cbiAgICAgIGlmIChwcm9wc1snb2JqZWN0LXBvc2l0aW9uJ10pXG4gICAgICAgIHJldHVybiBwYXJzZVBvc2l0aW9uKHByb3BzKTtcblxuICAgICAgcmV0dXJuIHByb3BzO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgYWxsIHRoZSByZWxldmFudCB2aWRlbyBlbGVtZW50cyBhbmQgZ2V0IHRoZW0gZml0dGVkXG4gICAqL1xuICBmdW5jdGlvbiBpbml0aWFsaXplICh2aWRlb3MpIHtcbiAgICB2YXIgaW5kZXggPSAtMTtcblxuICAgIGlmICghdmlkZW9zKSB7XG4gICAgICAvLyBpZiBubyB2aWRlb3MgZ2l2ZW4sIHF1ZXJ5IGFsbCB2aWRlbyBlbGVtZW50c1xuICAgICAgdmlkZW9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgndmlkZW8nKTtcbiAgICB9IGVsc2UgaWYgKCEoJ2xlbmd0aCcgaW4gdmlkZW9zKSkge1xuICAgICAgLy8gY29udmVydCB0byBhbiBhcnJheSBmb3IgcHJvcGVyIGxvb3BpbmcgaWYgYW4gYXJyYXkgb3IgTm9kZUxpc3RcbiAgICAgIC8vIHdhcyBub3QgZ2l2ZW5cbiAgICAgIHZpZGVvcyA9IFt2aWRlb3NdO1xuICAgIH1cblxuICAgIHdoaWxlICh2aWRlb3NbKytpbmRleF0pIHtcbiAgICAgIHZhciBzdHlsZSA9IGdldFN0eWxlKHZpZGVvc1tpbmRleF0pO1xuXG4gICAgICAvLyBvbmx5IGRvIHdvcmsgaWYgdGhlIHByb3BlcnR5IGlzIG9uIHRoZSBlbGVtZW50XG4gICAgICBpZiAoc3R5bGVbJ29iamVjdC1maXQnXSB8fCBzdHlsZVsnb2JqZWN0LXBvc2l0aW9uJ10pIHtcbiAgICAgICAgLy8gc2V0IHRoZSBkZWZhdWx0IHZhbHVlc1xuICAgICAgICBzdHlsZVsnb2JqZWN0LWZpdCddID0gc3R5bGVbJ29iamVjdC1maXQnXSB8fCAnZmlsbCc7XG4gICAgICAgIGZpdEl0KHZpZGVvc1tpbmRleF0sIHN0eWxlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogT2JqZWN0IEZpdFxuICAgKiBAcGFyYW0gIHtvYmplY3R9ICRlbCBFbGVtZW50IHRvIGZpdFxuICAgKiBAcmV0dXJuIHtvYmplY3R9ICAgICBUaGUgZWxlbWVudCdzIHJlbGV2YW50IHByb3BlcnRpZXNcbiAgICovXG4gIGZ1bmN0aW9uIGZpdEl0ICgkZWwsIHN0eWxlKSB7XG4gICAgLy8gZmlsbCBpcyB0aGUgZGVmYXVsdCBiZWhhdmlvciwgbm8gYWN0aW9uIGlzIG5lY2Vzc2FyeVxuICAgIGlmIChzdHlsZVsnb2JqZWN0LWZpdCddID09PSAnZmlsbCcpXG4gICAgICByZXR1cm47XG5cbiAgICAvLyBjb252ZW5pZW5jZSBzdHlsZSBwcm9wZXJ0aWVzIG9uIHRoZSBzb3VyY2UgZWxlbWVudFxuICAgIHZhciBzZXRDc3MgPSAkZWwuc3R5bGUsXG4gICAgICAgIGdldENzcyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKCRlbCk7XG5cbiAgICAvLyBjcmVhdGUgYW5kIGluc2VydCBhIHdyYXBwZXIgZWxlbWVudFxuICAgIHZhciAkd3JhcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29iamVjdC1maXQnKTtcbiAgICAkd3JhcC5hcHBlbmRDaGlsZCgkZWwucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoJHdyYXAsICRlbCkpO1xuXG4gICAgLy8gc3R5bGUgdGhlIHdyYXBwZXIgZWxlbWVudCB0byBtb3N0bHkgbWF0Y2ggdGhlIHNvdXJjZSBlbGVtZW50XG4gICAgdmFyIHdyYXBDc3MgPSB7XG4gICAgICBoZWlnaHQ6ICAgICcxMDAlJyxcbiAgICAgIHdpZHRoOiAgICAgJzEwMCUnLFxuICAgICAgYm94U2l6aW5nOiAnY29udGVudC1ib3gnLFxuICAgICAgZGlzcGxheTogICAnaW5saW5lLWJsb2NrJyxcbiAgICAgIG92ZXJmbG93OiAgJ2hpZGRlbidcbiAgICB9O1xuXG4gICAgJ2JhY2tncm91bmRDb2xvciBiYWNrZ3JvdW5kSW1hZ2UgYm9yZGVyQ29sb3IgYm9yZGVyU3R5bGUgYm9yZGVyV2lkdGggYm90dG9tIGZvbnRTaXplIGxpbmVIZWlnaHQgbGVmdCBvcGFjaXR5IG1hcmdpbiBwb3NpdGlvbiByaWdodCB0b3AgdmlzaWJpbGl0eScucmVwbGFjZSgvXFx3Ky9nLCBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICB3cmFwQ3NzW2tleV0gPSBnZXRDc3Nba2V5XTtcbiAgICB9KTtcblxuICAgIGZvciAodmFyIGtleSBpbiB3cmFwQ3NzKVxuICAgICAgJHdyYXAuc3R5bGVba2V5XSA9IHdyYXBDc3Nba2V5XTtcblxuICAgIC8vIGdpdmUgdGhlIHNvdXJjZSBlbGVtZW50IHNvbWUgc2FuZXIgc3R5bGVzXG4gICAgc2V0Q3NzLmJvcmRlciAgPSBzZXRDc3MubWFyZ2luID0gc2V0Q3NzLnBhZGRpbmcgPSAwO1xuICAgIHNldENzcy5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICBzZXRDc3Mub3BhY2l0eSA9IDE7XG5cbiAgICAvLyBzZXQgdXAgdGhlIGV2ZW50IGhhbmRsZXJzXG4gICAgJGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZG1ldGFkYXRhJywgZG9Xb3JrKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignb3B0aW1pemVkUmVzaXplJywgZG9Xb3JrKTtcblxuICAgIC8vIHdlIG1heSBoYXZlIG1pc3NlZCB0aGUgbG9hZGVkbWV0YWRhdGEgZXZlbnQsIHNvIGlmIHRoZSB2aWRlbyBoYXMgbG9hZGVkXG4gICAgLy8gZW5vdWdoIGRhdGEsIGp1c3QgZHJvcCB0aGUgZXZlbnQgbGlzdGVuZXIgYW5kIGV4ZWN1dGVcbiAgICBpZiAoJGVsLnJlYWR5U3RhdGUgPj0gMSkge1xuICAgICAgJGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2xvYWRlZG1ldGFkYXRhJywgZG9Xb3JrKTtcbiAgICAgIGRvV29yaygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERvIHRoZSBhY3R1YWwgc2l6aW5nLiBNYXRoLlxuICAgICAqIEBtZXRob2RPZiBmaXRJdFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGRvV29yayAoKSB7XG4gICAgICAvLyB0aGUgYWN0dWFsIHNpemUgYW5kIHJhdGlvIG9mIHRoZSB2aWRlb1xuICAgICAgLy8gd2UgZG8gdGhpcyBoZXJlLCBldmVuIHRob3VnaCBpdCBkb2Vzbid0IGNoYW5nZSwgYmVjYXVzZVxuICAgICAgLy8gYXQgdGhpcyBwb2ludCB3ZSBjYW4gYmUgc3VyZSB0aGUgbWV0YWRhdGEgaGFzIGxvYWRlZFxuICAgICAgdmFyIHZpZGVvV2lkdGggID0gJGVsLnZpZGVvV2lkdGgsXG4gICAgICAgICAgdmlkZW9IZWlnaHQgPSAkZWwudmlkZW9IZWlnaHQsXG4gICAgICAgICAgdmlkZW9SYXRpbyAgPSB2aWRlb1dpZHRoIC8gdmlkZW9IZWlnaHQ7XG5cbiAgICAgIHZhciB3cmFwV2lkdGggID0gJHdyYXAuY2xpZW50V2lkdGgsXG4gICAgICAgICAgd3JhcEhlaWdodCA9ICR3cmFwLmNsaWVudEhlaWdodCxcbiAgICAgICAgICB3cmFwUmF0aW8gID0gd3JhcFdpZHRoIC8gd3JhcEhlaWdodDtcblxuICAgICAgdmFyIG5ld0hlaWdodCA9IDAsXG4gICAgICAgICAgbmV3V2lkdGggID0gMDtcbiAgICAgIHNldENzcy5tYXJnaW5MZWZ0ID0gc2V0Q3NzLm1hcmdpblRvcCA9IDA7XG5cbiAgICAgIC8vIGJhc2ljYWxseSB3ZSBkbyB0aGUgb3Bwb3NpdGUgYWN0aW9uIGZvciBjb250YWluIGFuZCBjb3ZlcixcbiAgICAgIC8vIGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSB2aWRlbyBhc3BlY3QgcmF0aW8gaXMgbGVzcyB0aGFuIG9yXG4gICAgICAvLyBncmVhdGVyIHRoYW4gdGhlIHdyYXBwZXIncyBhc3BlY3QgcmF0aW9cbiAgICAgIGlmICh2aWRlb1JhdGlvIDwgd3JhcFJhdGlvID9cbiAgICAgICAgICBzdHlsZVsnb2JqZWN0LWZpdCddID09PSAnY29udGFpbicgOiBzdHlsZVsnb2JqZWN0LWZpdCddID09PSAnY292ZXInKSB7XG4gICAgICAgIG5ld0hlaWdodCA9IHdyYXBIZWlnaHQgKiB2aWRlb1JhdGlvO1xuICAgICAgICBuZXdXaWR0aCAgPSB3cmFwV2lkdGggLyB2aWRlb1JhdGlvO1xuXG4gICAgICAgIHNldENzcy53aWR0aCAgPSBNYXRoLnJvdW5kKG5ld0hlaWdodCkgKyAncHgnO1xuICAgICAgICBzZXRDc3MuaGVpZ2h0ID0gd3JhcEhlaWdodCArICdweCc7XG5cbiAgICAgICAgaWYgKHN0eWxlWydvYmplY3QtcG9zaXRpb24teCddID09PSAnbGVmdCcpXG4gICAgICAgICAgc2V0Q3NzLm1hcmdpbkxlZnQgPSAwO1xuICAgICAgICBlbHNlIGlmIChzdHlsZVsnb2JqZWN0LXBvc2l0aW9uLXgnXSA9PT0gJ3JpZ2h0JylcbiAgICAgICAgICBzZXRDc3MubWFyZ2luTGVmdCA9IE1hdGgucm91bmQod3JhcFdpZHRoIC0gbmV3SGVpZ2h0KSArICdweCc7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICBzZXRDc3MubWFyZ2luTGVmdCA9IE1hdGgucm91bmQoKHdyYXBXaWR0aCAtIG5ld0hlaWdodCkgLyAyKSArICdweCc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXdXaWR0aCA9IHdyYXBXaWR0aCAvIHZpZGVvUmF0aW87XG5cbiAgICAgICAgc2V0Q3NzLndpZHRoICAgICA9IHdyYXBXaWR0aCArICdweCc7XG4gICAgICAgIHNldENzcy5oZWlnaHQgICAgPSBNYXRoLnJvdW5kKG5ld1dpZHRoKSArICdweCc7XG5cbiAgICAgICAgaWYgKHN0eWxlWydvYmplY3QtcG9zaXRpb24teSddID09PSAndG9wJylcbiAgICAgICAgICBzZXRDc3MubWFyZ2luVG9wID0gMDtcbiAgICAgICAgZWxzZSBpZiAoc3R5bGVbJ29iamVjdC1wb3NpdGlvbi15J10gPT09ICdib3R0b20nKVxuICAgICAgICAgIHNldENzcy5tYXJnaW5Ub3AgPSBNYXRoLnJvdW5kKHdyYXBIZWlnaHQgLSBuZXdXaWR0aCkgKyAncHgnO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgc2V0Q3NzLm1hcmdpblRvcCA9IE1hdGgucm91bmQoKHdyYXBIZWlnaHQgLSBuZXdXaWR0aCkgLyAyKSArICdweCc7XG4gICAgICB9XG5cbiAgICAgIC8vIHBsYXkgdGhlIHZpZGVvIGlmIGF1dG9wbGF5IGlzIHNldFxuICAgICAgaWYgKCRlbC5hdXRvcGxheSlcbiAgICAgICAgJGVsLnBsYXkoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU3BsaXQgdGhlIG9iamVjdC1wb3NpdGlvbiBwcm9wZXJ0eSBpbnRvIHggYW5kIHkgcG9zaXRpb24gcHJvcGVydGllc1xuICAgKiBAcGFyYW0gIHtvYmplY3R9IHN0eWxlIFJlbGV2YW50IGVsZW1lbnQgc3R5bGVzXG4gICAqIEByZXR1cm4ge29iamVjdH0gICAgICAgVGhlIHN0eWxlIG9iamVjdCB3aXRoIHRoZSBhZGRlZCB4IGFuZCB5IHByb3BzXG4gICAqL1xuICBmdW5jdGlvbiBwYXJzZVBvc2l0aW9uIChzdHlsZSkge1xuICAgIGlmICh+c3R5bGVbJ29iamVjdC1wb3NpdGlvbiddLmluZGV4T2YoJ2xlZnQnKSlcbiAgICAgIHN0eWxlWydvYmplY3QtcG9zaXRpb24teCddID0gJ2xlZnQnO1xuICAgIGVsc2UgaWYgKH5zdHlsZVsnb2JqZWN0LXBvc2l0aW9uJ10uaW5kZXhPZigncmlnaHQnKSlcbiAgICAgIHN0eWxlWydvYmplY3QtcG9zaXRpb24teCddID0gJ3JpZ2h0JztcbiAgICBlbHNlXG4gICAgICBzdHlsZVsnb2JqZWN0LXBvc2l0aW9uLXgnXSA9ICdjZW50ZXInO1xuXG4gICAgaWYgKH5zdHlsZVsnb2JqZWN0LXBvc2l0aW9uJ10uaW5kZXhPZigndG9wJykpXG4gICAgICBzdHlsZVsnb2JqZWN0LXBvc2l0aW9uLXknXSA9ICd0b3AnO1xuICAgIGVsc2UgaWYgKH5zdHlsZVsnb2JqZWN0LXBvc2l0aW9uJ10uaW5kZXhPZignYm90dG9tJykpXG4gICAgICBzdHlsZVsnb2JqZWN0LXBvc2l0aW9uLXknXSA9ICdib3R0b20nO1xuICAgIGVsc2VcbiAgICAgIHN0eWxlWydvYmplY3QtcG9zaXRpb24teSddID0gJ2NlbnRlcic7XG5cbiAgICByZXR1cm4gc3R5bGU7XG4gIH1cblxuICAvKipcbiAgICogVGhyb3R0bGUgYW4gZXZlbnQgd2l0aCBSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgQVBJIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2VcbiAgICogQHBhcmFtICB7c3RyaW5nfSB0eXBlIFRoZSBldmVudCB0byB0aHJvdHRsZVxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IG5hbWUgQ3VzdG9tIGV2ZW50IG5hbWUgdG8gbGlzdGVuIGZvclxuICAgKiBAcGFyYW0gIHtvYmplY3R9IG9iaiAgT3B0aW9uYWwgb2JqZWN0IHRvIGF0dGFjaCB0aGUgZXZlbnQgdG9cbiAgICovXG4gIGZ1bmN0aW9uIHRocm90dGxlICh0eXBlLCBuYW1lLCBvYmopIHtcbiAgICBvYmogPSBvYmogfHwgd2luZG93O1xuICAgIHZhciBydW5uaW5nID0gZmFsc2UsXG4gICAgICAgIGV2dCAgICAgPSBudWxsO1xuXG4gICAgLy8gSUUgZG9lcyBub3Qgc3VwcG9ydCB0aGUgQ3VzdG9tRXZlbnQgY29uc3RydWN0b3JcbiAgICAvLyBzbyBpZiB0aGF0IGZhaWxzIGRvIGl0IHRoZSBvbGQgd2F5XG4gICAgdHJ5IHtcbiAgICAgIGV2dCA9IG5ldyBDdXN0b21FdmVudChuYW1lKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnQnKTtcbiAgICAgIGV2dC5pbml0RXZlbnQobmFtZSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgdmFyIGZ1bmMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAocnVubmluZykgcmV0dXJuO1xuXG4gICAgICBydW5uaW5nID0gdHJ1ZTtcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIG9iai5kaXNwYXRjaEV2ZW50KGV2dCk7XG4gICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBvYmouYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBmdW5jKTtcbiAgfVxufTtcblxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpXG4gIG1vZHVsZS5leHBvcnRzID0gb2JqZWN0Rml0VmlkZW9zO1xuIl19"}